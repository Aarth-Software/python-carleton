from neo4j import GraphDatabase
x={
  "JournalPaper": {
    "id": 143268,
    "title": "Contracting for innovation: Designing contracts that account for exchange hazards and the need for innovation",
    "abstract": "Research Summary: We examine how organizations govern interfirm transactions that involve innovative tasks. Designing contracts that foster innovation is challenging and becomes more complex when exchange hazards are present. We draw on regulatory focus theory to examine the effects of promotion and prevention effects in contract framing contracts to address how firms should design their contracts to balance the need for promoting innovation and protecting against opportunistic behavior. Using a sample of contracts from the information technology services industry, we find that in the presence of exchange hazards, task innovation involves hybrid payment systems, less use of detailed description of requirements, and more use of extensive contingency planning. Managerial Summary: Managers must understand how contract design can aid in the success of interfirm innovation endeavors as radical innovation is frequently developed in an interfirm context. Our findings suggest that contract negotiat ors should pay special attention to several contractual elements when designing contracts for tasks that require more radical innovation. In particular, the payment structure, specifications of outcomes and processes, and contingency planning clauses influence the innovative output of suppliers. Employees who understand the task should participate in contract negotiation and design, allowing them to outsource more innovative tasks and manage them more effectively. Â© 2022 The Authors. Strategic Management Journal published by John Wiley & Sons Ltd.",
    "coden": "SMAJD",
    "correspondence_address": "Mayer, K.J.; Management and Organization, United States; email: kmayer@marshall.usc.edu",
    "doi": "10.1002/smj.3409",
    "issn": "1432095",
    "volume": "43",
    "issue": "11",
    "page_start": "2253",
    "page_end": "2278",
    "teiFileID": "tei_files/tei_parsing/A comparison of alternative measures of organizational aspirations.xml",
    "scopusURL": "https://www.scopus.com/inward/record.uri?eid=2-s2.0-85130850973&doi=10.1002%2fsmj.3409&partnerID=40&md5=f8a7e06fe10d24e6a08f8dfb7be1384e",
    "Empirical": {
    "isEmpirical": "True"
    },
    "Conceptual": {
    "isConceptual": "True"
    },
    "Hypothesis": [
    {
      "statement": "Hypothesis 1. When an outsourced task entails more radical innovation (when compared with an outsourced task with incremental innovation), it will entail a contract that includes (a) a hybrid payment structure (T&M with a cap), (b) a more detailed description of the requirements, and (c) less emphasis on contingency planning",
      "Construct": [
      {
        "name": "outsourced task entails more radical innovation",
        "ConstructRole": "IV"
      },
      {
        "name": "outsourced task with incremental innovation",
        "ConstructRole": "DV"
      },
      {
        "name": "contract that includes (a) a hybrid payment structure (T&M with a cap), (b) a more detailed description of the requirements, and (c) less emphasis on contingency planning.",
        "ConstructRole": "Mediator"
      },
      {
        "name": "outsourced task with incremental innovation",
        "ConstructRole": "Moderator"
      }
      ]
    },
    {
      "statement": "Hypothesis 2. When an outsourced task is more radically innovative and involves exchange hazards, it will entail a contract that includes (a) a T&M payment structure, (b) a less detailed description of requirements, and (c) more contingency planning compared with an outsourced radically innovative task that faces no or fewer exchange hazards.",
      "Construct": [
      {
        "name": "outsourced task is more radically innovative and involvesexchange hazards",
        "ConstructRole": "Mediator"
      },
      {
        "name": "contract that includes (a) a T&M payment structure, (b) a less detailed description of requirements, and (c) more contingency planning compared with an outsourced radically innovative task that faces no or fewer exchange hazards.",
        "ConstructRole": "Moderator"
      }
      ]
    }
    ],
    "Keyword": {
    "name": [
      "contracting",
      "innovation",
      "transaction cost economics"
    ]
    },
    "Data": {
    "name": "We test our hypotheses using data from the information technology (IT) services industry, which involves tasks with widely varying levels of innovation. Service industries often involve innovation and complexities in knowledge management (and protection), requiring new ideas as technologies change rapidly (e.g., Leiponen, 2008). We use proprietary data on a large IT firm's information technology service contracts and its different suppliers. Using a sample of 385 contracts between the buyer and 141 suppliers identifying IT tasks, including, but not limited to, improving network design and security, creating customized software systems, and updating existing systems."
    },
    "Year": {
    "name": "2022"
    },
    "Author": [
    {
      "givenNames": "K.J.",
      "lastName": "Mayer",
      "scopusID": "7201681844",
      "orcid": "7201681844",
      "Affiliation": {
      "name": "Management and Organization, Marshall School of Business, University of Southern California, Los Angeles, CA, United States",
      "address": ""
      }
    },
    {
      "givenNames": "Z.",
      "lastName": "Xing",
      "scopusID": "57713662200",
      "orcid": "57713662200",
      "Affiliation": {
      "name": "Management and Entrepreneurship, Leavey School of Business, Santa Clara University, Santa Clara, CA, United States",
      "address": ""
      }
    },
    {
      "givenNames": "P.",
      "lastName": "Mondal",
      "scopusID": "57712839500",
      "orcid": "57712839500",
      "Affiliation": {
      "name": "CPG Analytical Consultant LeadNSW, Australia",
      "address": ""
      }
    }
    ],
    "Funding Agency": {
    "name": "",
    "acknowledgement": ""
    },
    "Journal Publication": {
    "name": "John Wiley and Sons Ltd",
    "abbreviatedName": "Strategic Manage J",
    "issn": "1432095",
    "type": "",
    "location": "Cananda",
    "url": "",
    "field": "Strategy"
    },
    "Publisher": {
    "name": "John Wiley and Sons Ltd"
    },
    "BibliographicReference": [
    {
      "citedAs": "",
      "title": "",
      "authors": "",
      "yearPublished": "",
      "sourceTitle": "",
      "volume": "",
      "issue": "",
      "startPage": "",
      "endPage": "",
      "location": ""
    },
    {
      "citedAs": "",
      "title": "",
      "authors": "",
      "yearPublished": "",
      "sourceTitle": "",
      "volume": "",
      "issue": "",
      "startPage": "",
      "endPage": "",
      "location": ""
    },
    {
      "citedAs": "",
      "title": "",
      "authors": "",
      "yearPublished": "",
      "sourceTitle": "",
      "volume": "",
      "issue": "",
      "startPage": "",
      "endPage": "",
      "location": ""
    },
    {
      "citedAs": "",
      "title": "",
      "authors": "",
      "yearPublished": "",
      "sourceTitle": "",
      "volume": "",
      "issue": "",
      "startPage": "",
      "endPage": "",
      "location": ""
    },
    {
      "citedAs": "",
      "title": "",
      "authors": "",
      "yearPublished": "",
      "sourceTitle": "",
      "volume": "",
      "issue": "",
      "startPage": "",
      "endPage": "",
      "location": ""
    },
    {
      "citedAs": "",
      "title": "",
      "authors": "",
      "yearPublished": "",
      "sourceTitle": "",
      "volume": "",
      "issue": "",
      "startPage": "",
      "endPage": "",
      "location": ""
    }
    ]
  }
  }

# print(f"parent_node will be {list(x.keys())[0]}")

keys=list(x["JournalPaper"].keys())
cn=[]
for key in keys:
    value=x["JournalPaper"][key]
    if isinstance(x["JournalPaper"][key],dict):
        cn.append(key)
# print("child node will be")
# print(cn)
#forn root node properties
keys=x["JournalPaper"].keys()
reqst={}
for key in keys:
    if isinstance(x["JournalPaper"][key],str):
        #print(key)
        reqst.update({key:x["JournalPaper"][key]})
#print(reqst)
driver=GraphDatabase.driver(uri="bolt://localhost:7687",auth=("neo4j","Admin@123"))
session=driver.session()

set_of_nodes=['Empirical', 'Conceptual', 'Keyword', 'Data', 'Year', 'Funding_Agency', 'Journal_Publication', 'Publisher']
#create Empirical

rEmpirical=x["JournalPaper"]["Empirical"]
rConceptual=x["JournalPaper"]["Conceptual"]
rKeyword=x["JournalPaper"]["Keyword"]
rData=x["JournalPaper"]["Data"]
rYear=x["JournalPaper"]["Year"]
rFunding_Agency=x["JournalPaper"]["Funding Agency"]
rJournal_Publication=x["JournalPaper"]["Journal Publication"]
rPublisher=x["JournalPaper"]["Publisher"]
q1="""
create(a:JournalPaper) set a=$reqst
create(b:Empirical) set b=$rEmpirical
create(c:Conceptual) set c=$rConceptual
create(d:Keyword) set d=$rKeyword
create(e:Data) set e=$rData
create(f:Year) set f=$rYear
create(g:Funding_Agency) set g=$rFunding_Agency
create(h:Journal_Publication) set h=$rJournal_Publication
create(i:Publisher) set i=$rPublisher
create(a)-[:HAS_TYPE]->(b)
create(a)-[:HAS_TYPE]->(c)
create(a)-[:HAS]->(d)
create(a)-[:USED]->(e)
create(a)-[:IN]->(f)
create(a)-[:FUNDED]->(g)
create(a)-[:APPEARED_IN]->(h)
create(h)-[:PUBLISHED_BY]->(i)
"""



likey=[]
for key in keys:
  if isinstance(x["JournalPaper"][key],list):
      #print(key)
      for reqst in x["JournalPaper"][key]:
        # print(reqst)
        internal_keys=reqst.keys()
        reqst1={}
        for ik in internal_keys:
          #print(ik)
          #reqst1={}
          if isinstance(reqst[ik],str):
            # print(ik)
            reqst1.update({ik:reqst[ik]})
            # print(reqst1)
            if key=="Author":
              # print("here")
              q2="""
              create(a:Author) set a=$reqst1
              """
              try:
                dict={"reqst1":reqst1}
                session.run(q2,dict)
              except Exception as e:
                print(str(e))

            elif key=="Hypothesis":
              # print("here")
              q3="""
              create(a:Hypothesis) set a=$reqst1
              """
              try:
                dict={"reqst1":reqst1}
                session.run(q3,dict)
              except Exception as e:
                print(str(e))
            
            elif key=="BibliographicReference":
              # print("here")
              q4="""
              create(a:BibliographicReference) set a=$reqst1
              """
              try:
                dict={"reqst1":reqst1}
                session.run(q4,dict)
              except Exception as e:
                print(str(e))






dict={"reqst":reqst,"rEmpirical":rEmpirical,"rConceptual":rConceptual,"rKeyword":rKeyword,"rData":rData,"rYear":rYear,"rFunding_Agency":rFunding_Agency,"rJournal_Publication":rJournal_Publication,"rPublisher":rPublisher}
results=session.run(q1,dict)
li=results.consume().counters.nodes_created
result={"nodes added":li}
print(result)